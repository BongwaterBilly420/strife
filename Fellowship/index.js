(function(S,u,p,a,s,_,x,l){"use strict";const y=function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(t){return typeof t=="object"&&!Array.isArray(t)};return[e,n(e[e.length-1])?e.pop():{}]},c=function(e,n){return n.all?a.findAll(e):a.find(e)},L=function(e){return c(e,{all:!0})},g={byProps:function(e){return function(n){return e.every(function(t){return n[t]!==void 0})}},byDisplayName:function(e,n){return n?function(t){return t?.displayName===e}:function(t){return t?.default?.displayName===e}},byTypeName:function(e,n){return n?function(t){return t?.type?.name===e}:function(t){return t?.default?.type?.name===e}},byName:function(e,n){return n?function(t){return t?.name===e}:function(t){return t?.default?.name===e}}};var O=Object.freeze({__proto__:null,filters:g,getByDisplayName:function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];const[r,o]=y(n);return c(g.byDisplayName(r[0],o.default),o)},getByName:function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];const[r,o]=y(n);return c(g.byName(r[0],o.default),o)},getByProps:function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];const[r,o]=y(n);return c(g.byProps(r),o)},getByTypeName:function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];const[r,o]=y(n);return c(g.byTypeName(r[0],o.default),o)},getModule:c,getModules:L});const C=a.common.constants,U=a.common.clipboard,E=a.findByProps("registerAsset"),F=a.findByProps("recieveMessage","sendMessage"),G=a.findByProps("createBotMessage"),H=a.findByProps("BOT_AVATARS"),V=a.common.ReactNative.NativeModules,K=a.common.React,q=a.common.FluxDispatcher,J=a.findByProps("getItem"),Q=a.common.toasts,W=a.findByProps("show","openLazy","close"),X=a.findByProps("getToken"),Y=a.findByProps("getAPIBaseURL"),Z=a.findByProps("watchKeys"),ee=a.findByProps("getCurrentUser"),ne=a.findByProps("getUser","fetchProfile"),te=a.common.navigation,re=a.common.NavigationNative,ae=a.common.navigationStack,oe=a.findByProps("theme"),se=a.common.ReactNative.Linking,D=a.common.stylesheet,ie={ThemeColorMap:s.semanticColors,Colors:s.rawColors},ue=s.semanticColors,le=s.rawColors,ce={Forms:p.Forms,General:p.General},fe=a.findByProps("Messages"),ge=a.findByProps("showUserProfile"),de=a.findByProps("debounce","throttle"),me=a.findByName("Logger"),pe=a.common.Flux,ye=a.findByProps("Svg"),he=a.findByName("getScreens",!1),ve=a.common.moment;C.ThemeColorMap=s.semanticColors,D.ThemeColorMap=s.semanticColors;var be=Object.freeze({__proto__:null,Assets:E,AsyncUsers:ne,Avatars:H,Clipboard:U,Clyde:G,ColorMap:ie,Colors:le,Components:ce,Constants:C,Dialog:W,Dispatcher:q,Flux:pe,Linking:se,Locale:fe,Lodash:de,Logger:me,Messages:F,Moment:ve,Native:V,Navigation:te,NavigationNative:re,NavigationStack:ae,Profiles:ge,REST:Y,React:K,SVG:ye,Scenes:he,Settings:Z,Storage:J,StyleSheet:D,Theme:oe,ThemeColorMap:ue,Toasts:Q,Token:X,Users:ee});const f={};function h(e,n,t){return f[e]||(f[e]={before:[],instead:[],after:[]}),f[e][n].push(t),{unpatch:t}}function v(e,n){switch(e){case"before":return function(t,r){return n(this,t,r),r(...t)};case"instead":return function(t,r){return n(this,t,r)};case"after":return function(t,r){return n(this,t,r)}}}const I=function(e,n,t,r,o){return h(e,"before",u.patcher.instead(t,n,v("before",r),o))},M=function(e,n,t,r,o){return h(e,"instead",u.patcher.instead(t,n,v("instead",r),o))},A=function(e,n,t,r,o){return h(e,"after",u.patcher.after(t,n,v("after",r),o))},b=function(e){return[...f[e].before,...f[e].instead,...f[e].after]},R=function(e){return b(e).forEach(function(n){return n()})};var Pe=Object.freeze({__proto__:null,after:A,before:I,create:function(e){return{getPatchesByCaller:function(){return b(e)},before:function(n,t,r,o){return I(e,n,t,r,o)},instead:function(n,t,r,o){return M(e,n,t,r,o)},after:function(n,t,r,o){return A(e,n,t,r,o)},unpatchAll:function(){return R(e)}}},getPatchesByCaller:b,instead:M,unpatchAll:R});function P(e,n){return u.logger.warn(`Tried to call ${e}, not implemented!`),n}_.storage.plugins??={};let B={},i=_.storage.plugins;function k(e){if(typeof e!="object")return;const n=Object.entries(i).find(function(t){let[,r]=t;return r.name===e.name})[0];B[n]={onStart:e.onStart,onStop:e.onStop,onEnable:e.onEnable,onDisable:e.onDisable}}const z=function(e,n){return x.without({...e,...n},"script","enabled")},N=function(e){return(e?Object.entries(i).filter(e):Object.entries(i)).map(function(n){let[t,r]=n;return z(r,B[t])})};function Be(e){const[n,t]=Object.entries(i).find(function(r){let[,o]=r;return o.name===e});return z(t,B[n])}const Ne=function(){return N()},we=function(){return N(function(e){let[,n]=e;return n.enabled})},Te=function(){return N(function(e){let[,n]=e;return!n.enabled})},Se=function(e){return new Proxy(window.enmity.plugins,{get(n,t){return t!=="registerPlugin"?Reflect.get(n,t):function(r){return i[e]??={name:r.name,description:r.description,version:r.version,authors:r.authors},k(r)}}})};async function $(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const t=i[e]?.script??await(await fetch(e)).text(),r={...window.enmity,plugins:Se(e)},o=new Proxy(window,{get(m,T){if(T=="window")return o;switch(T){case"vendetta":case"__vendetta_theme":case"__vendetta_loader":case"__vendetta_rdc":return;case"enmity":return r;default:return m[T]}}});try{await(0,eval)(`((window, enmity) => { ${t} })`)(o,r)}catch(m){console.error(m.stack)}return i[e].script=t,i[e].enabled=n,i[e].name}function _e(e,n){$(e,!0)}var Ce=Object.freeze({__proto__:null,evalPlugin:$,getDisabledPlugins:Te,getEnabledPlugins:we,getPlugin:Be,getPlugins:Ne,installPlugin:_e,registerPlugin:k,uninstallPlugin:async function(){return P("uninstallPlugin")}});const{uuid4:De}=a.findByProps("uuid4"),Ie=function(e){return l.lodash.memoize(e)},Me=function(e,n){return l.lodash.debounce(e,n)},Ae=function(){return P("createStore",{})},Re=function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(r){return r},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return u.utils.findInTree(e,n,{walkable:["props","children"],...t})},ke=l.ReactNative.PixelRatio.getPixelSizeForLayoutSize;var ze=Object.freeze({__proto__:null,createStore:Ae,debounce:Me,findInReactTree:Re,findInTree:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(m){return m},{ignore:t=[],walkable:r=[],maxProperties:o=100}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return u.utils.findInTree(e,n,{ignore:t,walkable:r,maxDepth:o})},memoize:Ie,normalizeSize:ke,sleep:function(e){return new Promise(function(n){return setTimeout(n,e)})},uuid:De,wrapInHooks:function(){return P("wrapInHooks",l.React.createElement(l.ReactNative.Text,{},"Stubbed wrapInHooks"))}});const{NativeModules:d}=l.ReactNative,w=d.InfoDictionaryManager??d.RTNClientInfoManager,j=d.DCDDeviceManager??d.RTNDeviceManager,$e=d.BundleUpdaterManager,je=w.Identifier,xe=$e.reload,Le=w.Version,Oe=j.systemVersion,Ue=w.Build,Ee=j.device;var Fe=Object.freeze({__proto__:null,build:Ue,bundle:je,device:Ee,os:Oe,reload:xe,version:Le});const Ge=s.assets.all,He=s.assets.find,Ve=function(e){return s.assets.getAssetByName(e)},Ke=function(e){return s.assets.getAssetByID(e)},qe=function(e){return s.assets.getAssetIDByName(e)},Je=new Proxy({},{get:function(e,n){return s.assets.getAssetIDByName(n)}});var Qe=Object.freeze({__proto__:null,Icons:Je,assets:Ge,find:He,getByID:Ke,getByName:Ve,getIDByName:qe});function We(){return globalThis.enmity={modules:{...O,common:be},patcher:Pe,version:`Fellowship ${u.plugin.manifest.hash.slice(7)}`,plugins:Ce,utilities:ze,components:new Proxy({},{get:function(e,n){return p.General[n]??p.Forms[n]}}),native:Fe,assets:Qe},function(){return delete globalThis.enmity}}const Xe=[We()],Ye=function(){return Xe.forEach(function(e){return e()})};return S.onUnload=Ye,S})({},vendetta,vendetta.ui.components,vendetta.metro,vendetta.ui,vendetta.plugin,vendetta.utils,vendetta.metro.common);
